<div class="profile-container" *ngIf="!showEditMode">
  <div class="profile-header">
    <img class="profile-avatar" src="{{profileDetails.imageUrl}}" alt="User Avatar" />
    <div class="profile-info">
      <h2>{{profileDetails.username}}</h2>
      <p>Email: {{profileDetails.email}}</p>
      <div class="profile-actions">
        <a class="btn edit-btn" (click)="onEdit()">Edit Profile</a>
        <a class="btn logout-btn" (click)="logout()">Logout</a>
      </div>
    </div>
  </div>

  <h3 class="section-title">My Recipes</h3>
  <div class="recipe-list">
    <div class="recipe-card" *ngFor="let recipe of myRecipes">
      <img src="{{recipe.imageUrl}}" alt="Recipe" />
      <div class="recipe-content">
        <h4>{{recipe.title}}</h4>
        <p>Protein: {{recipe.protein}}g | Calories: {{recipe.calories}}kcal</p>
        <a [routerLink]="['/recipes', recipe.id]"class="read-more-btn">View</a>
      </div>
    </div>
  </div>
</div>

<div class="edit-profile-container" *ngIf="showEditMode">
  <h1>Edit Profile</h1>
  
  <form #form="ngForm">
    <div class="form-group">
      <label>Username</label>
      <input type="text" placeholder="Enter your full name" name="username" #inputUsername="ngModel" [(ngModel)]="profileDetails.username" required minlength="3"/>
       <ng-container *ngIf="inputUsername.touched">
      <p class="error" *ngIf="inputUsername.errors?.['required']">
        Username is required!
      </p>
      <p class="error" *ngIf="inputUsername.errors?.['minlength']">
        Username must be at least 3 characters!
      </p>
    </ng-container>
    </div>

    <div class="form-group">
      <label>Email</label>
      <input type="email" placeholder="Enter your email" name="email" #inputEmail="ngModel" [(ngModel)]="profileDetails.email" required [appEmail]="domains"/>
      <ng-container *ngIf="inputEmail.touched">
        <p class="error" *ngIf="inputEmail.errors?.['required']">
          Email is required!
        </p>
        <p class="error" *ngIf="inputEmail.errors?.['emailValidator']">
          Email is not valid!
        </p>
      </ng-container>
    </div>

    <div class="form-group">
      <label>Profile Image URL</label>
      <input type="text" placeholder="Paste image link here" name="imageUrl" [(ngModel)]="profileDetails.imageUrl" />
    </div>

    <div class="form-preview">
      <p>Preview:</p>
      <img src="{{profileDetails.imageUrl}}" alt="Profile Preview" class="profile-avatar" />
    </div>

    <div class="form-actions">
      <button class="save-btn" (click)="saveProfile(form)">Save</button>
      <button class="cancel-btn" (click)="cancelEdit($event)">Cancel</button>
    </div>
  </form>
</div>
